"use strict";(self.webpackChunksandbox=self.webpackChunksandbox||[]).push([[561],{1466:(P,m,o)=>{o.r(m),o.d(m,{Pillar:()=>Z,Plane:()=>V,RaycastVehicleComponent:()=>C,RaycastVehicleComponentModule:()=>pe,World:()=>Q});var i=o(9662),r=o(3152),u=o(5313),p=o(397),g=o(4372),y=o(7814),_=o(6071),d=o(2313),x=o(1165),f=o(610),S=o(1955),e=o(9796),D=o(5913);const J=["ref",""],v=function(s){return[0,s,0]},T=function(){return["material","transparent"]},A=function(){return["material","color"]};function L(s,a){if(1&s&&(e.ynx(0),e.TgZ(1,"ngt-mesh",1)(2,"ngt-group",2),e._UZ(3,"ngt-mesh",3)(4,"ngt-mesh",3)(5,"ngt-mesh",3)(6,"ngt-mesh",3)(7,"ngt-mesh",3)(8,"ngt-mesh",3)(9,"ngt-mesh",3)(10,"ngt-mesh",3),e.TgZ(11,"ngt-mesh",3),e._UZ(12,"ngt-value",4)(13,"ngt-value",5),e.qZA(),e._UZ(14,"ngt-mesh",3)(15,"ngt-mesh",3)(16,"ngt-mesh",3)(17,"ngt-mesh",3)(18,"ngt-mesh",3)(19,"ngt-mesh",3)(20,"ngt-mesh",3),e.qZA()(),e.BQk()),2&s){const t=a.ngIf,n=e.oxw();e.xp6(1),e.Q6J("ref",n.ref)("position",n.position)("rotation",n.rotation),e.xp6(1),e.Q6J("position",e.VKq(39,v,-.6)),e.xp6(1),e.Q6J("material",t.materials["Black paint"])("geometry",t.nodes.chassis_1.geometry),e.xp6(1),e.Q6J("material",t.materials.Rubber)("geometry",t.nodes.chassis_2.geometry),e.xp6(1),e.Q6J("material",t.materials.Paint)("geometry",t.nodes.chassis_3.geometry),e.xp6(1),e.Q6J("material",t.materials.Underbody)("geometry",t.nodes.chassis_4.geometry),e.xp6(1),e.Q6J("material",t.materials.Chrom)("geometry",t.nodes.chassis_5.geometry),e.xp6(1),e.Q6J("material",t.materials["Interior (dark)"])("geometry",t.nodes.chassis_6.geometry),e.xp6(1),e.Q6J("material",t.materials["Interior (light)"])("geometry",t.nodes.chassis_7.geometry),e.xp6(1),e.Q6J("material",t.materials.Reflector)("geometry",t.nodes.chassis_8.geometry),e.xp6(1),e.Q6J("material",t.materials.Glass)("geometry",t.nodes.chassis_9.geometry),e.xp6(1),e.Q6J("attach",e.DdM(41,T))("value",!0),e.xp6(1),e.Q6J("attach",e.DdM(42,A)),e.xp6(1),e.Q6J("material",t.materials.Steel)("geometry",t.nodes.chassis_10.geometry),e.xp6(1),e.Q6J("material",t.materials["Black plastic"])("geometry",t.nodes.chassis_11.geometry),e.xp6(1),e.Q6J("material",t.materials.Headlight)("geometry",t.nodes.chassis_12.geometry),e.xp6(1),e.Q6J("material",t.materials["Reverse lights"])("geometry",t.nodes.chassis_13.geometry),e.xp6(1),e.Q6J("material",t.materials["Orange plastic"])("geometry",t.nodes.chassis_14.geometry),e.xp6(1),e.Q6J("material",t.materials["Tail lights"])("geometry",t.nodes.chassis_15.geometry),e.xp6(1),e.Q6J("material",t.materials["License Plate"])("geometry",t.nodes.chassis_16.geometry)}}const F=function(s){return[0,0,s]};function N(s,a){if(1&s&&(e.ynx(0),e.TgZ(1,"ngt-group",1)(2,"ngt-group",2),e.ALo(3,"radian"),e._UZ(4,"ngt-mesh",3)(5,"ngt-mesh",3)(6,"ngt-mesh",3),e.qZA()(),e.BQk()),2&s){const t=a.ngIf,n=e.oxw();e.xp6(1),e.Q6J("ref",n.ref),e.xp6(1),e.Q6J("rotation",e.VKq(10,F,e.lcZ(3,8,n.leftSide?90:-90))),e.xp6(2),e.Q6J("material",t.materials.Rubber)("geometry",t.nodes.wheel_1.geometry),e.xp6(1),e.Q6J("material",t.materials.Steel)("geometry",t.nodes.wheel_2.geometry),e.xp6(1),e.Q6J("material",t.materials.Chrom)("geometry",t.nodes.wheel_3.geometry)}}function K(s,a){if(1&s&&e._UZ(0,"sandbox-wheel",3),2&s){const t=a.$implicit,n=a.even,c=e.oxw();e.Q6J("ref",t)("radius",c.radius)("leftSide",n)}}let W=(()=>{class s{constructor(t){this.gltfLoader=t,this.beetle$=this.gltfLoader.load("assets/Beetle.glb")}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(D.iY))},s.\u0275cmp=e.Xpm({type:s,selectors:[["sandbox-chassis","ref",""]],inputs:{ref:"ref",position:"position",rotation:"rotation"},attrs:J,decls:2,vars:3,consts:[[4,"ngIf"],[3,"ref","position","rotation"],[3,"position"],["castShadow","",3,"material","geometry"],[3,"attach","value"],["value","black",3,"attach"]],template:function(t,n){1&t&&(e.YNc(0,L,21,43,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,n.beetle$))},dependencies:[f.O5,g.U,d.oX,u.mI,f.Ov],encapsulation:2,changeDetection:0}),s})(),O=(()=>{class s{constructor(t,n){this.gltfLoader=t,this.physicBody=n,this.radius=.7,this.leftSide=!1,this.wheel$=this.gltfLoader.load("assets/wheel.glb")}ngOnInit(){this.physicBody.useCompoundBody(()=>({collisionFilterGroup:0,mass:1,material:"wheel",shapes:[{args:[this.radius,this.radius,.5,16],rotation:[0,0,-Math.PI/2],type:"Cylinder"}],type:"Kinematic"}),!0,this.ref)}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(D.iY),e.Y36(i.CN))},s.\u0275cmp=e.Xpm({type:s,selectors:[["sandbox-wheel","ref",""]],inputs:{ref:"ref",radius:"radius",leftSide:"leftSide"},features:[e._Bn([i.CN])],attrs:J,decls:2,vars:3,consts:[[4,"ngIf"],[3,"ref"],[3,"rotation"],[3,"material","geometry"]],template:function(t,n){1&t&&(e.YNc(0,N,7,12,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,n.wheel$))},dependencies:[f.O5,g.U,d.oX,f.Ov,r.j4],encapsulation:2,changeDetection:0}),s})();const b={" ":"brake",ArrowDown:"backward",ArrowLeft:"left",ArrowRight:"right",ArrowUp:"forward",r:"reset"},Y=Object.keys(b),R=s=>Y.includes(s);let X=(()=>{class s{constructor(t,n){this.physicBody=t,this.physicRaycastVehicle=n,this.back=-1.15,this.force=1500,this.front=1.3,this.height=-.04,this.maxBrake=50,this.steer=.5,this.width=1.2,this.radius=.7,this.backward=!1,this.brake=!1,this.forward=!1,this.left=!1,this.reset=!1,this.right=!1,this.wheelInfo={axleLocal:[-1,0,0],customSlidingRotationalSpeed:-30,dampingCompression:4.4,dampingRelaxation:10,directionLocal:[0,-1,0],frictionSlip:2,maxSuspensionForce:1e4,maxSuspensionTravel:.3,radius:this.radius,suspensionRestLength:.3,suspensionStiffness:30,useCustomSlidingRotationalSpeed:!0},this.wheelInfo1={...this.wheelInfo,chassisConnectionPointLocal:[-this.width/2,this.height,this.front],isFrontWheel:!0},this.wheelInfo2={...this.wheelInfo,chassisConnectionPointLocal:[this.width/2,this.height,this.front],isFrontWheel:!0},this.wheelInfo3={...this.wheelInfo,chassisConnectionPointLocal:[-this.width/2,this.height,this.back],isFrontWheel:!1},this.wheelInfo4={...this.wheelInfo,chassisConnectionPointLocal:[this.width/2,this.height,this.back],isFrontWheel:!1},this.wheels=[new r.Rl,new r.Rl,new r.Rl,new r.Rl],this.chassisRef=this.physicBody.useBox(()=>({allowSleep:!1,angularVelocity:this.angularVelocity,args:[1.7,1,4],mass:500,onCollide:c=>console.log("bonk",c.body.userData),position:this.position,rotation:this.rotation})),this.raycastVehicleRef=this.physicRaycastVehicle.useRaycastVehicle(()=>({chassisBody:this.chassisRef.ref,wheelInfos:[this.wheelInfo1,this.wheelInfo2,this.wheelInfo3,this.wheelInfo4],wheels:this.wheels}))}onKeyUp(t){!R(t.key)||(this[b[t.key]]=!1)}onKeyDown(t){!R(t.key)||(this[b[t.key]]=!0)}onBeforeRender(){const{forward:t,backward:n,force:c,chassisRef:h,raycastVehicleRef:w,left:B,right:k,steer:fe,brake:ge,maxBrake:de,position:I,angularVelocity:U,rotation:M,reset:me}=this;if(w.ref.value&&h.ref.value&&this.wheels.every(l=>l.value)){for(let l=2;l<4;l++)w.api.applyEngineForce(t||n?c*(t&&!n?-1:1):0,2);for(let l=0;l<2;l++)w.api.setSteeringValue(B||k?fe*(B&&!k?1:-1):0,l);for(let l=2;l<4;l++)w.api.setBrake(ge?de:0,l);me&&I&&M&&U&&(h.api.position.set(...I),h.api.velocity.set(0,0,0),h.api.angularVelocity.set(...U),h.api.rotation.set(...M))}}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(i.CN),e.Y36(i.oP))},s.\u0275cmp=e.Xpm({type:s,selectors:[["sandbox-vehicle"]],hostBindings:function(t,n){1&t&&e.NdJ("keyup",function(h){return n.onKeyUp(h)},!1,e.Jf7)("keydown",function(h){return n.onKeyDown(h)},!1,e.Jf7)},inputs:{position:"position",rotation:"rotation",angularVelocity:"angularVelocity"},features:[e._Bn([i.CN,i.oP])],decls:3,vars:6,consts:[[3,"ref","position","beforeRender"],[3,"ref"],[3,"ref","radius","leftSide",4,"ngFor","ngForOf"],[3,"ref","radius","leftSide"]],template:function(t,n){1&t&&(e.TgZ(0,"ngt-group",0),e.NdJ("beforeRender",function(){return n.onBeforeRender()}),e._UZ(1,"sandbox-chassis",1),e.YNc(2,K,1,3,"sandbox-wheel",2),e.qZA()),2&t&&(e.Q6J("ref",n.raycastVehicleRef.ref)("position",e.VKq(4,v,-.4)),e.xp6(1),e.Q6J("ref",n.chassisRef.ref),e.xp6(1),e.Q6J("ngForOf",n.wheels))},dependencies:[f.sg,g.U,W,O],encapsulation:2,changeDetection:0}),s})();function H(s,a){1&s&&e._UZ(0,"sandbox-world")}function $(s,a){1&s&&(e.TgZ(0,"ngt-cannon-debug"),e._UZ(1,"sandbox-world"),e.qZA())}const E=function(){return[0,5,15]},q=function(s){return{fov:50,position:s}},j=function(){return["#171720",10,50]},z=function(){return[10,10,10]},G=function(){return{contactEquationRelaxation:4,friction:.001}},ee=function(s){return[s,0,0]},te=function(){return{id:"floor"}},se=function(){return[0,2,0]},ne=function(s){return[0,s,0]},ae=function(){return[0,.5,0]},oe=function(s,a){return[s,2.5,a]},ie=function(){return{id:"pillar-1"}},re=function(s){return[0,2.5,s]},le=function(){return{id:"pillar-2"}},ce=function(s){return[5,2.5,s]},he=function(){return{id:"pillar-3"}},ue=function(){return[100,100]};let C=(()=>{class s{constructor(){this.isDebugDisabled=!0}onKeyDown(t){"?"===t.key&&(this.isDebugDisabled=!this.isDebugDisabled)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["sandbox-raycast-vehicle"]],hostBindings:function(t,n){1&t&&e.NdJ("keyup",function(h){return n.onKeyDown(h)},!1,e.Jf7)},decls:17,vars:12,consts:[["initialLog","","shadows","",3,"camera"],["attach","fog",3,"fog"],["attach","background","color","#171720"],["intensity","0.1"],["castShadow","","angle","0.5","intensity","1","penumbra","1",3,"position"],["broadphase","SAP","allowSleep","",3,"defaultContactMaterial"],[4,"ngIf","ngIfElse"],["debugEnabled",""],["preset","night"],[1,"instruction"]],template:function(t,n){if(1&t&&(e.TgZ(0,"ngt-canvas",0),e._UZ(1,"ngt-fog",1)(2,"ngt-color",2)(3,"ngt-ambient-light",3)(4,"ngt-spot-light",4),e.TgZ(5,"ngt-physics",5),e.YNc(6,H,1,0,"sandbox-world",6),e.YNc(7,$,2,0,"ng-template",null,7,e.W1O),e.qZA(),e._UZ(9,"ngt-soba-environment",8),e.qZA(),e.TgZ(10,"div",9)(11,"pre"),e._uU(12,"* \u2191\u2190\u2193\u2192 to drive, space to brake\n        "),e._UZ(13,"br"),e._uU(14,"r to reset\n        "),e._UZ(15,"br"),e._uU(16,"? to debug\n      "),e.qZA()()),2&t){const c=e.MAs(8);e.Q6J("camera",e.VKq(7,q,e.DdM(6,E))),e.xp6(1),e.Q6J("fog",e.DdM(9,j)),e.xp6(3),e.Q6J("position",e.DdM(10,z)),e.xp6(1),e.Q6J("defaultContactMaterial",e.DdM(11,G)),e.xp6(1),e.Q6J("ngIf",n.isDebugDisabled)("ngIfElse",c)}},dependencies:function(){return[f.O5,r.B3,u.mh,u.rq,y.wx,y.KN,i.rZ,i.w8,x.$5,Q]},styles:[".instruction[_ngcontent-%COMP%]{color:#fff;font-size:1.2em;left:50px;position:absolute;top:20px}"],changeDetection:0}),s})(),Q=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["sandbox-world"]],decls:7,vars:32,consts:[[3,"rotation","userData"],[3,"position","rotation","angularVelocity"],[3,"position","userData"]],template:function(t,n){1&t&&(e._UZ(0,"sandbox-plane",0),e.ALo(1,"radian"),e._UZ(2,"sandbox-vehicle",1),e.ALo(3,"radian"),e._UZ(4,"sandbox-pillar",2)(5,"sandbox-pillar",2)(6,"sandbox-pillar",2)),2&t&&(e.Q6J("rotation",e.VKq(15,ee,e.lcZ(1,11,-90)))("userData",e.DdM(17,te)),e.xp6(2),e.Q6J("position",e.DdM(18,se))("rotation",e.VKq(19,ne,e.lcZ(3,13,-45)))("angularVelocity",e.DdM(21,ae)),e.xp6(2),e.Q6J("position",e.WLB(22,oe,-5,-5))("userData",e.DdM(25,ie)),e.xp6(1),e.Q6J("position",e.VKq(26,re,-5))("userData",e.DdM(28,le)),e.xp6(1),e.Q6J("position",e.VKq(29,ce,-5))("userData",e.DdM(31,he)))},dependencies:function(){return[V,Z,X,r.j4]},encapsulation:2,changeDetection:0}),s})(),V=(()=>{class s{constructor(t){this.physicBody=t,this.userData={},this.planeRef=this.physicBody.usePlane(()=>({material:"ground",rotation:this.rotation,type:"Static",userData:this.userData,args:[100,100]}))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(i.CN))},s.\u0275cmp=e.Xpm({type:s,selectors:[["sandbox-plane"]],inputs:{rotation:"rotation",userData:"userData"},features:[e._Bn([i.CN])],decls:4,vars:5,consts:[[3,"ref","rotation","userData"],["receiveShadow",""],[3,"args"],["color","#303030"]],template:function(t,n){1&t&&(e.TgZ(0,"ngt-group",0)(1,"ngt-mesh",1),e._UZ(2,"ngt-plane-geometry",2)(3,"ngt-mesh-standard-material",3),e.qZA()()),2&t&&(e.Q6J("ref",n.planeRef.ref)("rotation",n.rotation)("userData",n.userData),e.xp6(2),e.Q6J("args",e.DdM(4,ue)))},dependencies:[g.U,d.oX,p.U4,_.hv],encapsulation:2,changeDetection:0}),s})(),Z=(()=>{class s{constructor(t){this.physicBody=t,this.userData={},this.args=[.7,.7,5,16],this.pillarRef=this.physicBody.useCylinder(()=>({args:this.args,mass:10,position:this.position,userData:this.userData}))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(i.CN))},s.\u0275cmp=e.Xpm({type:s,selectors:[["sandbox-pillar"]],inputs:{position:"position",userData:"userData"},features:[e._Bn([i.CN])],decls:3,vars:4,consts:[[3,"ref","position","userData"],[3,"args"]],template:function(t,n){1&t&&(e.TgZ(0,"ngt-mesh",0),e._UZ(1,"ngt-cylinder-geometry",1)(2,"ngt-mesh-normal-material"),e.qZA()),2&t&&(e.Q6J("ref",n.pillarRef.ref)("position",n.position)("userData",n.userData),e.xp6(1),e.Q6J("args",n.args))},dependencies:[d.oX,p.ok,_.Ru],encapsulation:2,changeDetection:0}),s})(),pe=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[S.Bz.forChild([{path:"",component:C}]),f.ez,r.DX,u.vc,u.bg,y.EQ,y.Hk,i.M1,i.B$,g.I,d.M$,p.cM,_.To,r.kZ,p.eP,_.F8,x.wj,u.pk]}),s})()},2269:(P,m,o)=>{function i(r,u,p){return u in r?Object.defineProperty(r,u,{value:p,enumerable:!0,configurable:!0,writable:!0}):r[u]=p,r}o.d(m,{Z:()=>i})}}]);