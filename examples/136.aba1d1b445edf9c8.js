"use strict";(self.webpackChunksandbox=self.webpackChunksandbox||[]).push([[136],{2843:(U,p,i)=>{i.r(p),i.d(p,{Pillar:()=>R,Plane:()=>Q,RaycastVehicleComponent:()=>he,World:()=>Z});var o=i(2167),r=i(8368),u=i(8999),g=i(8786),d=i(2877),w=i(693),b=i(3545),m=i(3749),P=i(9612),f=i(5688),e=i(9709),x=i(6509);const D=["ref",""],J=function(s){return[0,s,0]},S=function(){return["material","transparent"]},T=function(){return["material","color"]};function A(s,a){if(1&s&&(e.ynx(0),e.TgZ(1,"ngt-mesh",1)(2,"ngt-group",2),e._UZ(3,"ngt-mesh",3)(4,"ngt-mesh",3)(5,"ngt-mesh",3)(6,"ngt-mesh",3)(7,"ngt-mesh",3)(8,"ngt-mesh",3)(9,"ngt-mesh",3)(10,"ngt-mesh",3),e.TgZ(11,"ngt-mesh",3),e._UZ(12,"ngt-value",4)(13,"ngt-value",5),e.qZA(),e._UZ(14,"ngt-mesh",3)(15,"ngt-mesh",3)(16,"ngt-mesh",3)(17,"ngt-mesh",3)(18,"ngt-mesh",3)(19,"ngt-mesh",3)(20,"ngt-mesh",3),e.qZA()(),e.BQk()),2&s){const t=a.ngIf,n=e.oxw();e.xp6(1),e.Q6J("ref",n.ref)("position",n.position)("rotation",n.rotation),e.xp6(1),e.Q6J("position",e.VKq(39,J,-.6)),e.xp6(1),e.Q6J("material",t.materials["Black paint"])("geometry",t.nodes.chassis_1.geometry),e.xp6(1),e.Q6J("material",t.materials.Rubber)("geometry",t.nodes.chassis_2.geometry),e.xp6(1),e.Q6J("material",t.materials.Paint)("geometry",t.nodes.chassis_3.geometry),e.xp6(1),e.Q6J("material",t.materials.Underbody)("geometry",t.nodes.chassis_4.geometry),e.xp6(1),e.Q6J("material",t.materials.Chrom)("geometry",t.nodes.chassis_5.geometry),e.xp6(1),e.Q6J("material",t.materials["Interior (dark)"])("geometry",t.nodes.chassis_6.geometry),e.xp6(1),e.Q6J("material",t.materials["Interior (light)"])("geometry",t.nodes.chassis_7.geometry),e.xp6(1),e.Q6J("material",t.materials.Reflector)("geometry",t.nodes.chassis_8.geometry),e.xp6(1),e.Q6J("material",t.materials.Glass)("geometry",t.nodes.chassis_9.geometry),e.xp6(1),e.Q6J("attach",e.DdM(41,S))("value",!0),e.xp6(1),e.Q6J("attach",e.DdM(42,T)),e.xp6(1),e.Q6J("material",t.materials.Steel)("geometry",t.nodes.chassis_10.geometry),e.xp6(1),e.Q6J("material",t.materials["Black plastic"])("geometry",t.nodes.chassis_11.geometry),e.xp6(1),e.Q6J("material",t.materials.Headlight)("geometry",t.nodes.chassis_12.geometry),e.xp6(1),e.Q6J("material",t.materials["Reverse lights"])("geometry",t.nodes.chassis_13.geometry),e.xp6(1),e.Q6J("material",t.materials["Orange plastic"])("geometry",t.nodes.chassis_14.geometry),e.xp6(1),e.Q6J("material",t.materials["Tail lights"])("geometry",t.nodes.chassis_15.geometry),e.xp6(1),e.Q6J("material",t.materials["License Plate"])("geometry",t.nodes.chassis_16.geometry)}}const L=function(s){return[0,0,s]};function M(s,a){if(1&s&&(e.ynx(0),e.TgZ(1,"ngt-group",1)(2,"ngt-group",2),e.ALo(3,"radian"),e._UZ(4,"ngt-mesh",3)(5,"ngt-mesh",3)(6,"ngt-mesh",3),e.qZA()(),e.BQk()),2&s){const t=a.ngIf,n=e.oxw();e.xp6(1),e.Q6J("ref",n.ref),e.xp6(1),e.Q6J("rotation",e.VKq(10,L,e.lcZ(3,8,n.leftSide?90:-90))),e.xp6(2),e.Q6J("material",t.materials.Rubber)("geometry",t.nodes.wheel_1.geometry),e.xp6(1),e.Q6J("material",t.materials.Steel)("geometry",t.nodes.wheel_2.geometry),e.xp6(1),e.Q6J("material",t.materials.Chrom)("geometry",t.nodes.wheel_3.geometry)}}function N(s,a){if(1&s&&e._UZ(0,"sandbox-wheel",3),2&s){const t=a.$implicit,n=a.even,c=e.oxw();e.Q6J("ref",t)("radius",c.radius)("leftSide",n)}}let F=(()=>{class s{constructor(t){this.gltfLoader=t,this.beetle$=this.gltfLoader.load("assets/Beetle.glb")}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(x.iY))},s.\u0275cmp=e.Xpm({type:s,selectors:[["sandbox-chassis","ref",""]],inputs:{ref:"ref",position:"position",rotation:"rotation"},standalone:!0,features:[e.jDz],attrs:D,decls:2,vars:3,consts:[[4,"ngIf"],[3,"ref","position","rotation"],[3,"position"],["castShadow","",3,"material","geometry"],[3,"attach","value"],["value","black",3,"attach"]],template:function(t,n){1&t&&(e.YNc(0,A,21,43,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,n.beetle$))},dependencies:[f.O5,f.Ov,m.oX,d.U,u.mI],encapsulation:2,changeDetection:0}),s})(),K=(()=>{class s{constructor(t,n){this.gltfLoader=t,this.physicBody=n,this.radius=.7,this.leftSide=!1,this.wheel$=this.gltfLoader.load("assets/wheel.glb")}ngOnInit(){this.physicBody.useCompoundBody(()=>({collisionFilterGroup:0,mass:1,material:"wheel",shapes:[{args:[this.radius,this.radius,.5,16],rotation:[0,0,-Math.PI/2],type:"Cylinder"}],type:"Kinematic"}),!0,this.ref)}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(x.iY),e.Y36(o.CN))},s.\u0275cmp=e.Xpm({type:s,selectors:[["sandbox-wheel","ref",""]],inputs:{ref:"ref",radius:"radius",leftSide:"leftSide"},standalone:!0,features:[e._Bn([o.CN]),e.jDz],attrs:D,decls:2,vars:3,consts:[[4,"ngIf"],[3,"ref"],[3,"rotation"],[3,"material","geometry"]],template:function(t,n){1&t&&(e.YNc(0,M,7,12,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,n.wheel$))},dependencies:[f.O5,f.Ov,d.U,m.oX,r.j4],encapsulation:2,changeDetection:0}),s})();const _={" ":"brake",ArrowDown:"backward",ArrowLeft:"left",ArrowRight:"right",ArrowUp:"forward",r:"reset"},W=Object.keys(_),v=s=>W.includes(s);let O=(()=>{class s{constructor(t,n){this.physicBody=t,this.physicRaycastVehicle=n,this.back=-1.15,this.force=1500,this.front=1.3,this.height=-.04,this.maxBrake=50,this.steer=.5,this.width=1.2,this.radius=.7,this.backward=!1,this.brake=!1,this.forward=!1,this.left=!1,this.reset=!1,this.right=!1,this.wheelInfo={axleLocal:[-1,0,0],customSlidingRotationalSpeed:-30,dampingCompression:4.4,dampingRelaxation:10,directionLocal:[0,-1,0],frictionSlip:2,maxSuspensionForce:1e4,maxSuspensionTravel:.3,radius:this.radius,suspensionRestLength:.3,suspensionStiffness:30,useCustomSlidingRotationalSpeed:!0},this.wheelInfo1={...this.wheelInfo,chassisConnectionPointLocal:[-this.width/2,this.height,this.front],isFrontWheel:!0},this.wheelInfo2={...this.wheelInfo,chassisConnectionPointLocal:[this.width/2,this.height,this.front],isFrontWheel:!0},this.wheelInfo3={...this.wheelInfo,chassisConnectionPointLocal:[-this.width/2,this.height,this.back],isFrontWheel:!1},this.wheelInfo4={...this.wheelInfo,chassisConnectionPointLocal:[this.width/2,this.height,this.back],isFrontWheel:!1},this.wheels=[new r.Rl,new r.Rl,new r.Rl,new r.Rl],this.chassisRef=this.physicBody.useBox(()=>({allowSleep:!1,angularVelocity:this.angularVelocity,args:[1.7,1,4],mass:500,onCollide:c=>console.log("bonk",c.body.userData),position:this.position,rotation:this.rotation})),this.raycastVehicleRef=this.physicRaycastVehicle.useRaycastVehicle(()=>({chassisBody:this.chassisRef.ref,wheelInfos:[this.wheelInfo1,this.wheelInfo2,this.wheelInfo3,this.wheelInfo4],wheels:this.wheels}))}onKeyUp(t){!v(t.key)||(this[_[t.key]]=!1)}onKeyDown(t){!v(t.key)||(this[_[t.key]]=!0)}onBeforeRender(){const{forward:t,backward:n,force:c,chassisRef:h,raycastVehicleRef:y,left:C,right:V,steer:ue,brake:fe,maxBrake:ge,position:B,angularVelocity:I,rotation:k,reset:pe}=this;if(y.ref.value&&h.ref.value&&this.wheels.every(l=>l.value)){for(let l=2;l<4;l++)y.api.applyEngineForce(t||n?c*(t&&!n?-1:1):0,2);for(let l=0;l<2;l++)y.api.setSteeringValue(C||V?ue*(C&&!V?1:-1):0,l);for(let l=2;l<4;l++)y.api.setBrake(fe?ge:0,l);pe&&B&&k&&I&&(h.api.position.set(...B),h.api.velocity.set(0,0,0),h.api.angularVelocity.set(...I),h.api.rotation.set(...k))}}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(o.CN),e.Y36(o.oP))},s.\u0275cmp=e.Xpm({type:s,selectors:[["sandbox-vehicle"]],hostBindings:function(t,n){1&t&&e.NdJ("keyup",function(h){return n.onKeyUp(h)},!1,e.Jf7)("keydown",function(h){return n.onKeyDown(h)},!1,e.Jf7)},inputs:{position:"position",rotation:"rotation",angularVelocity:"angularVelocity"},standalone:!0,features:[e._Bn([o.CN,o.oP]),e.jDz],decls:3,vars:6,consts:[[3,"ref","position","beforeRender"],[3,"ref"],[3,"ref","radius","leftSide",4,"ngFor","ngForOf"],[3,"ref","radius","leftSide"]],template:function(t,n){1&t&&(e.TgZ(0,"ngt-group",0),e.NdJ("beforeRender",function(){return n.onBeforeRender()}),e._UZ(1,"sandbox-chassis",1),e.YNc(2,N,1,3,"sandbox-wheel",2),e.qZA()),2&t&&(e.Q6J("ref",n.raycastVehicleRef.ref)("position",e.VKq(4,J,-.4)),e.xp6(1),e.Q6J("ref",n.chassisRef.ref),e.xp6(1),e.Q6J("ngForOf",n.wheels))},dependencies:[d.U,F,K,f.sg],encapsulation:2,changeDetection:0}),s})();const Y=function(){return[100,100]},X=function(s){return[s,0,0]},H=function(){return{id:"floor"}},j=function(){return[0,2,0]},z=function(s){return[0,s,0]},q=function(){return[0,.5,0]},E=function(s,a){return[s,2.5,a]},$=function(){return{id:"pillar-1"}},G=function(s){return[0,2.5,s]},ee=function(){return{id:"pillar-2"}},te=function(s){return[5,2.5,s]},se=function(){return{id:"pillar-3"}};function ne(s,a){1&s&&e._UZ(0,"sandbox-world")}function ae(s,a){1&s&&(e.TgZ(0,"ngt-cannon-debug"),e._UZ(1,"sandbox-world"),e.qZA())}const ie=function(){return[0,5,15]},oe=function(s){return{fov:50,position:s}},re=function(){return["#171720",10,50]},le=function(){return[10,10,10]},ce=function(){return{contactEquationRelaxation:4,friction:.001}};let Q=(()=>{class s{constructor(t){this.physicBody=t,this.userData={},this.planeRef=this.physicBody.usePlane(()=>({material:"ground",rotation:this.rotation,type:"Static",userData:this.userData,args:[100,100]}))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(o.CN))},s.\u0275cmp=e.Xpm({type:s,selectors:[["sandbox-plane"]],inputs:{rotation:"rotation",userData:"userData"},standalone:!0,features:[e._Bn([o.CN]),e.jDz],decls:4,vars:5,consts:[[3,"ref","rotation","userData"],["receiveShadow",""],[3,"args"],["color","#303030"]],template:function(t,n){1&t&&(e.TgZ(0,"ngt-group",0)(1,"ngt-mesh",1),e._UZ(2,"ngt-plane-geometry",2)(3,"ngt-mesh-standard-material",3),e.qZA()()),2&t&&(e.Q6J("ref",n.planeRef.ref)("rotation",n.rotation)("userData",n.userData),e.xp6(2),e.Q6J("args",e.DdM(4,Y)))},dependencies:[d.U,m.oX,g.U4,b.hv],encapsulation:2,changeDetection:0}),s})(),R=(()=>{class s{constructor(t){this.physicBody=t,this.userData={},this.args=[.7,.7,5,16],this.pillarRef=this.physicBody.useCylinder(()=>({args:this.args,mass:10,position:this.position,userData:this.userData}))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(o.CN))},s.\u0275cmp=e.Xpm({type:s,selectors:[["sandbox-pillar"]],inputs:{position:"position",userData:"userData"},standalone:!0,features:[e._Bn([o.CN]),e.jDz],decls:3,vars:4,consts:[[3,"ref","position","userData"],[3,"args"]],template:function(t,n){1&t&&(e.TgZ(0,"ngt-mesh",0),e._UZ(1,"ngt-cylinder-geometry",1)(2,"ngt-mesh-normal-material"),e.qZA()),2&t&&(e.Q6J("ref",n.pillarRef.ref)("position",n.position)("userData",n.userData),e.xp6(1),e.Q6J("args",n.args))},dependencies:[m.oX,g.ok,b.Ru],encapsulation:2,changeDetection:0}),s})(),Z=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["sandbox-world"]],standalone:!0,features:[e.jDz],decls:7,vars:32,consts:[[3,"rotation","userData"],[3,"position","rotation","angularVelocity"],[3,"position","userData"]],template:function(t,n){1&t&&(e._UZ(0,"sandbox-plane",0),e.ALo(1,"radian"),e._UZ(2,"sandbox-vehicle",1),e.ALo(3,"radian"),e._UZ(4,"sandbox-pillar",2)(5,"sandbox-pillar",2)(6,"sandbox-pillar",2)),2&t&&(e.Q6J("rotation",e.VKq(15,X,e.lcZ(1,11,-90)))("userData",e.DdM(17,H)),e.xp6(2),e.Q6J("position",e.DdM(18,j))("rotation",e.VKq(19,z,e.lcZ(3,13,-45)))("angularVelocity",e.DdM(21,q)),e.xp6(2),e.Q6J("position",e.WLB(22,E,-5,-5))("userData",e.DdM(25,$)),e.xp6(1),e.Q6J("position",e.VKq(26,G,-5))("userData",e.DdM(28,ee)),e.xp6(1),e.Q6J("position",e.VKq(29,te,-5))("userData",e.DdM(31,se)))},dependencies:[Q,O,R,r.j4],encapsulation:2,changeDetection:0}),s})(),he=(()=>{class s{constructor(){this.isDebugDisabled=!0}onKeyDown(t){"?"===t.key&&(this.isDebugDisabled=!this.isDebugDisabled)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["sandbox-raycast-vehicle"]],hostBindings:function(t,n){1&t&&e.NdJ("keyup",function(h){return n.onKeyDown(h)},!1,e.Jf7)},standalone:!0,features:[e.jDz],decls:17,vars:12,consts:[["initialLog","","shadows","",3,"camera"],["attach","fog",3,"fog"],["attach","background","color","#171720"],["intensity","0.1"],["castShadow","","angle","0.5","intensity","1","penumbra","1",3,"position"],["broadphase","SAP","allowSleep","",3,"defaultContactMaterial"],[4,"ngIf","ngIfElse"],["debugEnabled",""],["preset","night"],[1,"instruction"]],template:function(t,n){if(1&t&&(e.TgZ(0,"ngt-canvas",0),e._UZ(1,"ngt-fog",1)(2,"ngt-color",2)(3,"ngt-ambient-light",3)(4,"ngt-spot-light",4),e.TgZ(5,"ngt-physics",5),e.YNc(6,ne,1,0,"sandbox-world",6),e.YNc(7,ae,2,0,"ng-template",null,7,e.W1O),e.qZA(),e._UZ(9,"ngt-soba-environment",8),e.qZA(),e.TgZ(10,"div",9)(11,"pre"),e._uU(12,"* \u2191\u2190\u2193\u2192 to drive, space to brake\n        "),e._UZ(13,"br"),e._uU(14,"r to reset\n        "),e._UZ(15,"br"),e._uU(16,"? to debug\n      "),e.qZA()()),2&t){const c=e.MAs(8);e.Q6J("camera",e.VKq(7,oe,e.DdM(6,ie))),e.xp6(1),e.Q6J("fog",e.DdM(9,re)),e.xp6(3),e.Q6J("position",e.DdM(10,le)),e.xp6(1),e.Q6J("defaultContactMaterial",e.DdM(11,ce)),e.xp6(1),e.Q6J("ngIf",n.isDebugDisabled)("ngIfElse",c)}},dependencies:[r.B3,u.mh,u.rq,w.wx,w.KN,o.rZ,o.w8,P.$5,f.O5,Z],styles:[".instruction[_ngcontent-%COMP%]{color:#fff;font-size:1.2em;left:50px;position:absolute;top:20px}"],changeDetection:0}),s})()},2269:(U,p,i)=>{function o(r,u,g){return u in r?Object.defineProperty(r,u,{value:g,enumerable:!0,configurable:!0,writable:!0}):r[u]=g,r}i.d(p,{Z:()=>o})}}]);