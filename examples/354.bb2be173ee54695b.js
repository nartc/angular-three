"use strict";(self.webpackChunksandbox=self.webpackChunksandbox||[]).push([[354],{8354:($,f,a)=>{a.r(f),a.d(f,{HeightFieldExampleComponent:()=>Y});var u=a(2167),g=a(8368),x=a(8999),y=a(693),B=a(1210),M=a(6076),S=a(3545),v=a(3749),C=a(5e3),z=a(8786),Q=a(8926),F=a(969),e=a(9709);const w=["elementSize","","heights",""],D=["*"];let J=(()=>{class t extends z.DE{constructor(){super(...arguments),this.elementSize=0}set heights(n){this.set({heights:n})}ngOnInit(){super.ngOnInit(),this.zone.runOutsideAngular(()=>{this.store.onReady(()=>{this.effect((0,Q.b)(()=>{if(!this.instanceValue)return;const n=this.get(o=>o.heights),s=this.elementSize,c=this.elementSize,p=n.flatMap((o,r)=>o.flatMap((m,h)=>[r*s,h*c,m])),l=[];for(let o=0;o<n.length-1;o++)for(let r=0;r<n[o].length-1;r++){const m=n[o].length,h=o*m+r;l.push(h+1,h+m,h+m+1),l.push(h+m,h+1,h)}this.instanceValue.setIndex(l),this.instanceValue.setAttribute("position",new F.a$l(p,3)),this.instanceValue.computeVertexNormals(),this.instanceValue.computeBoundingBox(),this.instanceValue.computeBoundingSphere()}))(this.select(this.instance$,this.select(n=>n.heights)))})})}}return t.\u0275fac=function(){let i;return function(s){return(i||(i=e.n5z(t)))(s||t)}}(),t.\u0275cmp=e.Xpm({type:t,selectors:[["sandbox-height-field-geometry","elementSize","","heights",""]],inputs:{elementSize:"elementSize",heights:"heights"},standalone:!0,features:[e._Bn([(0,g.Pc)(t),(0,g.O2)(t)]),e.qOj,e.jDz],attrs:w,ngContentSelectors:D,decls:1,vars:0,template:function(n,s){1&n&&(e.F$t(),e.Hsn(0))},encapsulation:2,changeDetection:0}),t})();const b=["elementSize","","heights","","position","","rotation",""];let V=(()=>{class t{constructor(n){this.physicBody=n,this.elementSize=0,this.heights=[],this.position=[0,0,0],this.rotation=[0,0,0],this.color=C[17][4],this.heightFieldRef=this.physicBody.useHeightfield(()=>({args:[this.heights,{elementSize:this.elementSize}],position:this.position,rotation:this.rotation}))}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(u.CN))},t.\u0275cmp=e.Xpm({type:t,selectors:[["sandbox-height-field","elementSize","","heights","","position","","rotation",""]],inputs:{elementSize:"elementSize",heights:"heights",position:"position",rotation:"rotation"},standalone:!0,features:[e._Bn([u.CN]),e.jDz],attrs:b,decls:3,vars:4,consts:[["castShadow","","receiveShadow","",3,"ref"],[3,"color"],[3,"elementSize","heights"]],template:function(n,s){1&n&&(e.TgZ(0,"ngt-mesh",0),e._UZ(1,"ngt-mesh-phong-material",1)(2,"sandbox-height-field-geometry",2),e.qZA()),2&n&&(e.Q6J("ref",s.heightFieldRef.ref),e.xp6(1),e.Q6J("color",s.color),e.xp6(1),e.Q6J("elementSize",s.elementSize)("heights",s.heights))},dependencies:[v.oX,S.l6,J],encapsulation:2,changeDetection:0}),t})();var Z=a(5688);const j=["columns","","rows","","spread",""],T=function(){return[.2,16,16]},I=function(){return["attributes","color"]},O=function(t){return[t,3]};function U(t,i){if(1&t&&(e.ynx(0),e.TgZ(1,"ngt-instanced-mesh",1)(2,"ngt-sphere-geometry",2),e._UZ(3,"ngt-instanced-buffer-attribute",3),e.qZA(),e._UZ(4,"ngt-mesh-phong-material",4),e.qZA(),e.BQk()),2&t){const n=i.ngIf,s=e.oxw();e.xp6(1),e.Q6J("count",n.number)("ref",s.sphereRef.ref),e.xp6(1),e.Q6J("args",e.DdM(5,T)),e.xp6(1),e.Q6J("attach",e.DdM(6,I))("args",e.VKq(7,O,n.colors))}}let E=(()=>{class t extends g.gU{constructor(n){super(),this.physicBody=n,this.spread=0,this.sphereRef=this.physicBody.useSphere(s=>({args:[.2],mass:1,position:[(s%this.get(c=>c.columns)-(this.get(c=>c.columns)-1)/2)*this.spread,2,(Math.floor(s/this.get(c=>c.columns))-(this.get(c=>c.rows)-1)/2)*this.spread]})),this.viewModel$=this.select(this.select(s=>s.columns),this.select(s=>s.rows),(s,c)=>{const p=s*c,l=new Float32Array(3*p),o=new F.Ilk;for(let r=0;r<p;r++)o.set(C[17][Math.floor(5*Math.random())]).convertSRGBToLinear().toArray(l,3*r);return{colors:l,number:p}})}set columns(n){this.set({columns:(0,g.su)(n)})}set rows(n){this.set({rows:(0,g.su)(n)})}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(u.CN))},t.\u0275cmp=e.Xpm({type:t,selectors:[["sandbox-spheres","columns","","rows","","spread",""]],inputs:{columns:"columns",rows:"rows",spread:"spread"},standalone:!0,features:[e._Bn([u.CN]),e.qOj,e.jDz],attrs:j,decls:2,vars:3,consts:[[4,"ngIf"],["castShadow","","receiveShadow","",3,"count","ref"],[3,"args"],[3,"attach","args"],["vertexColors",""]],template:function(n,s){1&n&&(e.YNc(0,U,5,9,"ng-container",0),e.ALo(1,"async")),2&n&&e.Q6J("ngIf",e.lcZ(1,1,s.viewModel$))},dependencies:[Z.O5,Z.Ov,v.fk,z.ov,x.aS,S.l6],encapsulation:2,changeDetection:0}),t})();const G=function(t){return[0,t,10]},L=function(t){return{position:t}},N=function(){return[0,3,0]},P=function(t,i){return[t,0,i]},R=function(t){return[t,0,0]};let Y=(()=>{class t{constructor(){this.scale=10,this.heights=function X({width:t,height:i,number:n,scale:s}){const c=[],p=[];for(let o=0;o<n;o++)p.push([Math.random(),Math.random()]);let l=0;for(let o=0;o<t;o++){const r=[];for(let m=0;m<i;m++){let h=1/0;p.forEach(A=>{const H=(A[0]-o/t)**2+(A[1]-m/i)**2;H<h&&(h=H)});const d=Math.sqrt(h);d>l&&(l=d),r.push(d)}c.push(r)}for(let o=0;o<t;o++)for(let r=0;r<i;r++)c[o][r]*=s/l;return c}({height:128,number:10,scale:1,width:128})}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["sandbox-height-field-example"]],inputs:{scale:"scale"},standalone:!0,features:[e.jDz],decls:12,vars:25,consts:[["shadows","",3,"camera"],["attach","background","color","#171720"],["enableDamping","","dampingFactor","0.2",3,"minPolarAngle","maxPolarAngle"],["intensity","0.5"],["castShadow","",3,"position"],[3,"elementSize","heights","position","rotation"],["rows","3","columns","3",3,"spread"]],template:function(n,s){1&n&&(e.TgZ(0,"ngt-canvas",0),e._UZ(1,"ngt-color",1)(2,"ngt-soba-orbit-controls",2),e.ALo(3,"radian"),e.ALo(4,"radian"),e.TgZ(5,"ngt-physics"),e._UZ(6,"ngt-ambient-light",3)(7,"ngt-directional-light",4)(8,"sandbox-height-field",5),e.ALo(9,"radian"),e._UZ(10,"sandbox-spheres",6),e.qZA(),e._UZ(11,"ngt-stats"),e.qZA()),2&n&&(e.Q6J("camera",e.VKq(17,L,e.VKq(15,G,-10))),e.xp6(2),e.Q6J("minPolarAngle",e.lcZ(3,9,60))("maxPolarAngle",e.lcZ(4,11,60)),e.xp6(5),e.Q6J("position",e.DdM(19,N)),e.xp6(1),e.Q6J("elementSize",s.scale/128)("heights",s.heights)("position",e.WLB(20,P,-s.scale/2,s.scale/2))("rotation",e.VKq(23,R,e.lcZ(9,13,-90))),e.xp6(2),e.Q6J("spread",4))},dependencies:[g.B3,x.rq,M.St,u.rZ,y.wx,y.YY,B.Q,V,g.j4,E],encapsulation:2,changeDetection:0}),t})()}}]);